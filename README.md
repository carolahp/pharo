# Why Generating Small Pharo Kernels?
A full Pharo image is too big for running in small hardware constrained devices (i.e. arduino), and in many cases we don't need all the capabilities of the system when the goal is to use it only for executing a specific application after deploying.

In this project we present the Pharo Bootstrapper application, which allows you to design and generate your own custom Pharo images (also named Kernels). 

# How does the Pharo Bootstrapper works?
The Pharo Bootstrapper is an application that runs in Pharo. It works by reading the source files (in Tonel format) where all the classes of your custom system are defined, and after by generating a .image file which can be executed using the headless Pharo Virtual Machine. 

This application was developed using the previous work of [@Guillep](https://github.com/guillep) on the [Pharo Bootstrap Process](https://github.com/guillep/PharoBootstrap).

# How to start generating small images using the Pharo Bootstrapper?
To play start playing with it, you need to clone this repository and checkout the branch candle 
```bash
git clone --branch bootstrapInPharo8 https://github.com/carolahp/pharo.git
cd pharo
```

To generate the environment for the Pharo Bootstrapper, execute the next command: 
(don't forget the -m flag, for manual, or it will explode! ... at least for now)
```bash
BUILD_NUMBER=42 BOOTSTRAP_ARCH=32 bash ./bootstrap/scripts/bootstrap.sh -m
```

A Pharo system will automatically start, showing the Pharo Bootstrapper window.
![alt text](https://github.com/carolahp/pharo/blob/bootstrapInPharo8/images/bootstrapper.png "Pharo Bootstrapper UI")

To open a Pharo Bootstrapper again you must execute:
```Smalltalk
PBBuilder new open
```

In your custom image you define any class of the system, even core classes such as Object, Class and Metaclass, the only limitation is the compatibility with the Pharo Virtual Machine.

## Pharo Bootstrapper UI explanation
The bootstrapper UI is divided in 3 main sections:
![alt text](https://github.com/carolahp/pharo/blob/bootstrapInPharo8/images/bootstrapper-sections.png "Pharo Bootstrapper UI by sections")

### Section A

In this section you work with the definition of the language before bootstrapping your image (kernel). The definition of the language includes all the classes and methods that your generated kernel will contain. 

In the first column you find the repositories of the language, which are packages stored in disk in Tonel format. To load a repository into memory and start working with it you push the button under (1). 

In the central 2 columns you select the packages (2) to include in your kernel and you can modify the code of their classes and methods. There's an issue and is that package selection is being ignored for now, so a kernel will contain all the packages of the language repository. Another issue is that the remotion of packages using the code editor (Calypso) is ignored too, to remove a package you need to do it manually, deleting the package folder in the Tonel repository.  (you can open the folder that contains the language definitions pushing the button to the left of (1))

In the right column you select what you want to install in your kernel, you can name it and generate it in memory using the button under (3). The generation process will start, it will take less than one minute for Candle and at the end you will have the generated kernel loaded in memory, but not written in disk yet.
    You can generate a kernel that contains only the classes of the language definition but not the methods nor the app entry point. This kind of kernels can't be executed but the Pharo virtual machine, but they are useful for simulating execution of code (in B) and experimenting. Their advantage is that they can be generated very fast (less than 5 seconds for Candle)

### Section B 
In this section you can play with the generated kernel, which is loaded in memory. 
You can simulate the execution of code in your kernel and also debug it (4). This feature works only for the kernel you generated last. 

You can write this kernel to disk using (5). The kernel must be processed before writing it to disk, that's why it won't continue to be available to simulate execution of code in it. 

Please ignore for now the section under the button "External evaluate"

### Section C
Here you have a list of generated images (6). You can open the folder in which the images are generated by clicking (8). 

You can run any generated image using the Bash Script Runner, you must just complete the command ```./pharo``` with the name of the image and then click (7)
